# 🔐 صفحات ورود PlusMeet

## 📖 نمای کلی

PlusMeet دو صفحه ورود جداگانه دارد:

- **ورود کاربران عادی** (`/login`)
- **ورود پنل مدیریت** (`/admin/login`)

هر دو صفحه از دو روش احراز هویت پشتیبانی می‌کنند: **OTP** و **رمز عبور**.

---

## 🚪 صفحه ورود کاربران (`/login`)

### مسیر

```
http://localhost:3000/login
```

### ویژگی‌ها

#### 1️⃣ تب OTP (پیش‌فرض)

- ورود/ثبت‌نام با کد یکبار مصرف
- ارسال OTP از طریق SMS.ir
- تایمر شمارش معکوس (120 ثانیه)
- امکان ارسال مجدد پس از انقضای تایمر
- ثبت‌نام خودکار کاربران جدید

**فلو:**

```
ورود شماره موبایل → ارسال OTP → تایید کد →
  ├─ کاربر جدید → هدایت به /complete-profile
  └─ کاربر قدیمی → هدایت به /dashboard
```

#### 2️⃣ تب رمز عبور

- ورود سریع با شماره موبایل + رمز
- نمایش/مخفی کردن رمز
- لینک "فراموشی رمز عبور"

**فلو:**

```
ورود شماره + رمز → بررسی → ورود → /dashboard
```

### طراحی UI

```
┌─────────────────────────────────────┐
│        Logo PM (انیمیشن‌دار)        │
│      ورود به پلاس میت               │
│          با هم، بهتر                │
├─────────────────────────────────────┤
│  [ورود با کد] | [ورود با رمز]      │
├─────────────────────────────────────┤
│                                     │
│   📱 شماره موبایل                   │
│   [09123456789]                     │
│                                     │
│   🔑 کد تایید / رمز عبور            │
│   [• • • • •]                       │
│                                     │
│   [تایید و ورود]                   │
│                                     │
│   قوانین و مقررات را می‌پذیرید؟    │
├─────────────────────────────────────┤
│  بازگشت به صفحه اصلی | ورود ادمین   │
└─────────────────────────────────────┘
```

### تفاوت‌ها با لاگین ادمین

| ویژگی                 | لاگین کاربران                       | لاگین ادمین  |
| --------------------- | ----------------------------------- | ------------ |
| **هدف**               | کاربران عادی                        | مدیران سیستم |
| **عنوان**             | "ورود به پلاس میت"                  | "پنل مدیریت" |
| **متن تب OTP**        | "ورود با کد یکبار مصرف"             | "ورود با کد" |
| **دکمه تایید OTP**    | "تایید و ورود"                      | "ورود"       |
| **پیام قوانین**       | ✅ دارد                             | ❌ ندارد     |
| **لینک فراموشی رمز**  | ✅ دارد                             | ❌ ندارد     |
| **هدایت بعد از ورود** | `/dashboard` یا `/complete-profile` | `/admin`     |
| **لینک ادمین**        | ✅ دارد                             | ❌ ندارد     |

---

## 🔧 صفحه ورود ادمین (`/admin/login`)

### مسیر

```
http://localhost:3000/admin/login
```

### ویژگی‌ها

- طراحی مینیمال و حرفه‌ای
- دو تب: OTP / رمز عبور
- هدایت به `/admin` بعد از ورود
- بدون پیام قوانین (کاربران ادمین قبلاً تایید شده‌اند)

### طراحی UI

```
┌─────────────────────────────────────┐
│        Logo PM (انیمیشن‌دار)        │
│          پنل مدیریت                 │
│     PlusMeet Admin Panel            │
├─────────────────────────────────────┤
│    [ورود با کد] | [ورود با رمز]    │
├─────────────────────────────────────┤
│   📱 شماره موبایل                   │
│   [09123456789]                     │
│                                     │
│   [دریافت کد تایید]                │
├─────────────────────────────────────┤
│      بازگشت به صفحه اصلی             │
└─────────────────────────────────────┘
```

---

## 🎨 استایل‌های مشترک

### رنگ‌بندی

```css
/* Login Box */
background: var(--color-bg-default)
border: 1px solid var(--color-border)
box-shadow: var(--shadow-lg)
border-radius: 24px

/* دکمه اصلی */
background: linear-gradient(135deg, var(--color-primary), var(--color-accent))
color: white
box-shadow: 0 4px 12px rgba(244, 163, 37, 0.3)

/* تب فعال */
background: var(--color-primary)
color: white
box-shadow: 0 4px 12px rgba(244, 163, 37, 0.3)
```

### انیمیشن‌ها

```css
/* Login Box */
animation: fadeInUp 0.6s ease-out

/* Logo */
animation: pulse 2s ease-in-out infinite

/* Error Message */
animation: shake 0.5s ease
```

---

## 🔐 امنیت

### Validation

#### شماره موبایل

```javascript
// باید 11 رقم باشد
phoneNumber.length === 11;
// باید با 09 شروع شود
phoneNumber.startsWith("09");
```

#### کد OTP

```javascript
// باید 5 رقم باشد
otp.length === 5;
// فقط عدد
otp.replace(/\D/g, "");
```

#### رمز عبور

```javascript
// حداقل 6 کاراکتر
password.length >= 6;
```

### Rate Limiting

- **ارسال OTP**: حداکثر 1 بار در دقیقه
- **تایید OTP**: حداکثر 5 تلاش برای هر کد
- **ورود با رمز**: حداکثر 5 تلاش در 15 دقیقه

### Token Management

```javascript
// بعد از ورود موفق
{
  accessToken: "JWT token", // 1 ساعت
  refreshToken: "Refresh token", // 7 روز
  user: { ... }
}
```

---

## 📱 Responsive Design

### Desktop (> 1024px)

- Login Box: `max-width: 450px` (ادمین) / `480px` (کاربران)
- دو تب در کنار هم

### Mobile (< 640px)

- Login Box: `padding: 2rem 1.5rem`
- تب‌ها به صورت عمودی
- Footer عمودی

---

## 🎯 UX Details

### پیام‌های خطا

| خطا           | پیام فارسی                            |
| ------------- | ------------------------------------- |
| شماره نامعتبر | "شماره موبایل باید 11 رقم باشد"       |
| OTP ارسال نشد | "خطا در ارسال کد"                     |
| OTP نادرست    | "کد وارد شده صحیح نیست"               |
| OTP منقضی     | "کد منقضی شده است"                    |
| رمز نادرست    | "شماره موبایل یا رمز عبور اشتباه است" |
| کاربر مسدود   | "حساب کاربری شما مسدود شده است"       |

### Loading States

```jsx
{
  loading ? <span className={styles.spinner}></span> : "دریافت کد تایید";
}
```

### Countdown Timer

```
2:00 → 1:59 → ... → 0:01 → 0:00
```

بعد از 0:00، دکمه "ارسال مجدد کد" نمایش داده می‌شود.

---

## 🚀 استفاده

### کاربر جدید

1. رفتن به `/login`
2. وارد کردن شماره موبایل
3. دریافت OTP
4. تایید کد
5. **ثبت‌نام خودکار**
6. هدایت به `/complete-profile`

### کاربر قدیمی

#### با OTP

1. رفتن به `/login`
2. وارد کردن شماره موبایل
3. دریافت OTP
4. تایید کد
5. هدایت به `/dashboard`

#### با رمز عبور

1. رفتن به `/login`
2. کلیک روی "ورود با رمز عبور"
3. وارد کردن شماره + رمز
4. ورود
5. هدایت به `/dashboard`

---

## 🔗 لینک‌های مرتبط

- [پنل مدیریت](ADMIN_PANEL.md)
- [سیستم کاربری](USER_SYSTEM.md)
- [تنظیم SMS](SMS_SETUP.md)

---

## 🐛 Troubleshooting

### OTP ارسال نمی‌شود

```
✅ بررسی API Key در .env
✅ بررسی Template ID
✅ در Development: کد در console چاپ می‌شود
```

### نمی‌توانم وارد شوم

```
✅ شماره موبایل باید 11 رقم باشد
✅ کد OTP باید 5 رقم باشد
✅ بررسی MongoDB
```

### صفحه به درستی نمایش داده نمی‌شود

```
✅ Clear cache مرورگر
✅ بررسی console برای خطا
✅ npm run dev را دوباره اجرا کنید
```

---

**تاریخ آخرین به‌روزرسانی:** 27 اکتبر 2025






