# ๐ ูุฏุงู ูุฑุงุด ฺฉุงุฑุจุฑ (Edit User Modal)

> ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ ูุฏุงู ูุฑุงุด ฺฉุงูู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุฏุฑ ูพูู ุงุฏูู

## ๐ ูุณุฑ ุฏุณุชุฑุณ

```
/admin/users โ ฺฉูฺฉ ุฑู ุขฺฉูู โ๏ธ (ูุฑุงุด) ฺฉูุงุฑ ูุฑ ฺฉุงุฑุจุฑ
```

## ๐ฏ ูฺฺฏโูุง

### 1๏ธโฃ Tab Navigation

ูุฏุงู ุฏุงุฑุง **5 ุชุจ** ุงุณุช ฺฉู ุจุฑ ุงุณุงุณ ููุน ฺฉุงุฑุจุฑ (`userType`) ุจู ุตูุฑุช ุฏุงูุงูฺฉ ููุงุด ุฏุงุฏู ูโุดููุฏ:

#### ๐ ุงุทูุงุนุงุช ูพุงู (ููุดู ููุงุด ุฏุงุฏู ูโุดูุฏ)

- **ูุงู** \* (ุงุฌุจุงุฑ)
- **ูุงู ุฎุงููุงุฏฺฏ** \* (ุงุฌุจุงุฑ)
- **ูุงู ููุงุด**
- **ุงูู** (ุจุง Validation)
- **ฺฉุฏ ูู** (10 ุฑูู)
- **ุจูฺฏุฑุงู** (ุญุฏุงฺฉุซุฑ 500 ฺฉุงุฑุงฺฉุชุฑ)
- **ููุน ฺฉุงุฑุจุฑ** (Dropdown ุจุง 10 ฺฏุฒูู)
- **ูุถุนุช** (ูุนุงูุ ุฏุฑ ุงูุชุธุงุฑ ุชุงุฏุ ุชุงุฏ ุดุฏูุ ูุนูู)

#### ๐ค ุงุทูุงุนุงุช ุดุฎุต (ููุท ุจุฑุง `individual*`)

- **ุชุงุฑุฎ ุชููุฏ** (Date Picker)
- **ุฌูุณุช** (ูุฑุฏุ ุฒูุ ุณุงุฑ)
- **ุดูุฑ**
- **ุขุฏุฑุณ**

#### ๐ข ุงุทูุงุนุงุช ุณุงุฒูุงู (ููุท ุจุฑุง `organization*` ู `government`)

- **ูุงู ุณุงุฒูุงู**
- **ุดูุงุฑู ุซุจุช**
- **ุดูุงุณู ูู**
- **ูุจโุณุงุช** (ุจุง Validation URL)
- **ุงูู ุณุงุฒูุงู** (ุจุง Validation)
- **ุชูุถุญุงุช**

#### ๐บ๏ธ ุขุฏุฑุณ ู ุชูุงุณ (ููุท ุจุฑุง `organization*` ู `government`)

- **ุขุฏุฑุณ**:
  - ุดูุฑ
  - ุงุณุชุงู
  - ฺฉุฏ ูพุณุช (10 ุฑูู)
  - ุขุฏุฑุณ ฺฉุงูู
- **ุดุฎุต ุชูุงุณ**:
  - ูุงู
  - ุณูุช
  - ุดูุงุฑู ุชูุงุณ
  - ุงูู

#### ๐ ุดุจฺฉูโูุง ุงุฌุชูุงุน (ููุดู ููุงุด ุฏุงุฏู ูโุดูุฏ)

- **Instagram** (@username)
- **Telegram** (@username)
- **LinkedIn** (username)
- **Twitter/X** (@username)
- **Facebook** (username)
- **ูุจโุณุงุช ุดุฎุต** (URL)

---

## ๐ ุฏุณุชุฑุณโูุง (RBAC)

| ููุด           | ุฏุณุชุฑุณ                                    |
| ------------- | ----------------------------------------- |
| **Admin**     | โ ูุฑุงุด ููู ฺฉุงุฑุจุฑุงู (ุดุงูู Moderator ูุง) |
| **Moderator** | โ ูุฑุงุด ฺฉุงุฑุจุฑุงู (ุจู ุฌุฒ Admin ูุง)        |
| **User**      | โ ููุท ูุฑุงุด ูพุฑููุงู ุฎูุฏ (`/profile`)    |

### ูุญุฏูุฏุชโูุง ุงููุช:

- โ Moderator **ููโุชูุงูุฏ** Admin ุฑุง ูุฑุงุด ฺฉูุฏ
- โ Admin **ููโุชูุงูุฏ** ุฎูุฏุด ุฑุง ุญุฐู ฺฉูุฏ
- โ ููู ุชุบุฑุงุช ุฏุฑ `ActivityLog` ุซุจุช ูโุดููุฏ

---

## ๐๏ธ API Endpoints

### `GET /api/admin/users/:id`

- **ุชูุถุญุงุช**: ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉ ฺฉุงุฑุจุฑ
- **ุฏุณุชุฑุณ**: Admin, Moderator
- **Response**:

```json
{
  "success": true,
  "data": {
    "user": {
      /* ุงุทูุงุนุงุช ฺฉุงูู ฺฉุงุฑุจุฑ */
    }
  }
}
```

### `PUT /api/admin/users/:id`

- **ุชูุถุญุงุช**: ูุฑุงุด ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
- **ุฏุณุชุฑุณ**: Admin, Moderator (ุจู ุฌุฒ Admin ูุง)
- **Request Body**:

```json
{
  "firstName": "ุนู",
  "lastName": "ุงุญูุฏ",
  "email": "ali@example.com",
  "userType": "individual",
  "state": "active",
  "bio": "ุชูุถุญุงุช ฺฉูุชุงู..."
  // ููุฏูุง ุฏฺฏุฑ ุจุฑ ุงุณุงุณ userType
}
```

- **Response**:

```json
{
  "success": true,
  "message": "ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุง ููููุช ุจูโุฑูุฒุฑุณุงู ุดุฏ",
  "data": {
    "user": {
      /* ุงุทูุงุนุงุช ุจูโุฑูุฒ ุดุฏู */
    }
  }
}
```

### `DELETE /api/admin/users/:id`

- **ุชูุถุญุงุช**: ุญุฐู ฺฉุงุฑุจุฑ
- **ุฏุณุชุฑุณ**: ููุท Admin
- **Response**:

```json
{
  "success": true,
  "message": "ฺฉุงุฑุจุฑ ุจุง ููููุช ุญุฐู ุดุฏ"
}
```

---

## โ Validation ูุง

### ุงูู

```javascript
/^\S+@\S+\.\S+$/; // ุจุงุฏ ูุฑูุช ุงุณุชุงูุฏุงุฑุฏ ุงูู ุฏุงุดุชู ุจุงุดุฏ
```

### ฺฉุฏ ูู

```javascript
/^\d{10}$/; // ุจุงุฏ ุฏููุงู 10 ุฑูู ุจุงุดุฏ
```

### ุจูฺฏุฑุงู

```javascript
maxLength: 500; // ุญุฏุงฺฉุซุฑ 500 ฺฉุงุฑุงฺฉุชุฑ
```

### ฺฉุฏ ูพุณุช

```javascript
maxLength: 10; // ุญุฏุงฺฉุซุฑ 10 ฺฉุงุฑุงฺฉุชุฑ
```

---

## ๐จ UI/UX

### ุทุฑุงุญ

- โ **ูุฏุฑู ู ุชูุฒ**: ุทุฑุงุญ ูููุงู ุจุง ูุงุตููโฺฏุฐุงุฑ ููุงุณุจ
- โ **Tab Navigation**: ุชุจโูุง ูุงุจู ฺฉูฺฉ ุจุง transition ูุฑู
- โ **Responsive**: ุณุงุฒฺฏุงุฑ ุจุง ููุจุงูุ ุชุจูุชุ ุฏุณฺฉุชุงูพ
- โ **Dark Mode Ready**: ูพุดุชุจุงู ฺฉุงูู ุงุฒ ุชู ุชุฑู

### Animation ูุง

- **Modal Open**: Slide Up + Fade In (0.3s)
- **Tab Switch**: Fade In Content (0.3s)
- **Overlay**: Fade In (0.2s)
- **Buttons**: Hover + Active states

### ููุจุงู

- ุชุจโูุง ุจู ุตูุฑุช **horizontal scroll** ููุงุด ุฏุงุฏู ูโุดููุฏ
- ูุฑูโูุง ุงุฒ **2 ุณุชูู** ุจู **1 ุณุชูู** ุชุจุฏู ูโุดููุฏ
- ุฏฺฉููโูุง **full width** ูโุดููุฏ
- ูุฏุงู **full height** ูโุดูุฏ

---

## ๐ Activity Log

ุชูุงู ุนููุงุช ูุฑุงุด ุฏุฑ `ActivityLog` ุซุจุช ูโุดููุฏ:

```javascript
{
  userId: "09123456789",
  action: "user_update",
  targetId: "user._id",
  targetType: "User",
  metadata: {
    updatedUser: "09987654321",
    updatedFields: ["firstName", "email", "bio"],
  },
  status: "success",
  timestamp: "2025-10-29T12:34:56Z"
}
```

---

## ๐งช ูุญูู ุชุณุช

### 1๏ธโฃ ุชุณุช ูุฑุงุด ฺฉุงุฑุจุฑ ูุฑุฏ

1. ูุงุฑุฏ `/admin/users` ุดูุฏ
2. ฺฉ ฺฉุงุฑุจุฑ ุจุง `userType: "individual"` ูพุฏุง ฺฉูุฏ
3. ฺฉูฺฉ ุฑู ุขฺฉูู โ๏ธ
4. ุจู ุชุจ **ุงุทูุงุนุงุช ุดุฎุต** ุจุฑูุฏ
5. ููุฏ **ุชุงุฑุฎ ุชููุฏ** ู **ุฌูุณุช** ุฑุง ูพุฑ ฺฉูุฏ
6. ฺฉูฺฉ **ุฐุฎุฑู ุชุบุฑุงุช**
7. ฺฺฉ ฺฉูุฏ ฺฉู ุฏุงุฏูโูุง ุจุฏูู ุฎุทุง ุฐุฎุฑู ุดุฏูุฏ

### 2๏ธโฃ ุชุณุช ูุฑุงุด ฺฉุงุฑุจุฑ ุณุงุฒูุงู

1. ฺฉ ฺฉุงุฑุจุฑ ุจุง `userType: "organization"` ูพุฏุง ฺฉูุฏ
2. ฺฉูฺฉ ุฑู ุขฺฉูู โ๏ธ
3. ุจู ุชุจ **ุงุทูุงุนุงุช ุณุงุฒูุงู** ุจุฑูุฏ
4. ููุฏ **ูุงู ุณุงุฒูุงู** ู **ูุจโุณุงุช** ุฑุง ูพุฑ ฺฉูุฏ
5. ุจู ุชุจ **ุขุฏุฑุณ ู ุชูุงุณ** ุจุฑูุฏ
6. ููุฏูุง **ุขุฏุฑุณ** ู **ุดุฎุต ุชูุงุณ** ุฑุง ูพุฑ ฺฉูุฏ
7. ุฐุฎุฑู ฺฉูุฏ ู ฺฺฉ ฺฉูุฏ

### 3๏ธโฃ ุชุณุช Validation

1. ุงูู ูุงูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ: `invalid-email`
   - โ ุจุงุฏ ุฎุทุง ุจุฏูุฏ: "ูุฑูุช ุงูู ูุงูุนุชุจุฑ ุงุณุช"
2. ฺฉุฏ ูู 9 ุฑูู ูุงุฑุฏ ฺฉูุฏ: `123456789`
   - โ ุจุงุฏ ุฎุทุง ุจุฏูุฏ: "ฺฉุฏ ูู ุจุงุฏ 10 ุฑูู ุจุงุดุฏ"

### 4๏ธโฃ ุชุณุช RBAC

**ุจุง ุญุณุงุจ Moderator**:

1. ูุงุฑุฏ `/admin/users` ุดูุฏ
2. ฺฉ ฺฉุงุฑุจุฑ **Admin** ูพุฏุง ฺฉูุฏ
3. ุณุน ฺฉูุฏ ูุฑุงุดุด ฺฉูุฏ
   - โ ุจุงุฏ ุฎุทุง ุจุฏูุฏ: "ุดูุง ูุฌุงุฒ ุจู ูุฑุงุด ุงุฏูู ูุณุชุฏ"

---

## ๐ง ุนุจโุงุจ (Troubleshooting)

### ูุดฺฉู: ูุฏุงู ุจุงุฒ ููโุดูุฏ

**ุฑุงูโุญู**:

```javascript
// ฺฺฉ ฺฉูุฏ ฺฉู state ูุง ุฏุฑุณุช ุชูุธู ุดุฏูโุงูุฏ:
console.log("editModalOpen:", editModalOpen);
console.log("selectedUser:", selectedUser);
```

### ูุดฺฉู: Tab ูุง ููุงุด ุฏุงุฏู ููโุดููุฏ

**ุฑุงูโุญู**:

```javascript
// ฺฺฉ ฺฉูุฏ ฺฉู userType ุฏุฑุณุช ุงุณุช:
console.log("userType:", formData.userType);
console.log("isOrganization:", isOrganization);
console.log("isIndividual:", isIndividual);
```

### ูุดฺฉู: 403 Forbidden

**ุฑุงูโุญู**:

1. ฺฺฉ ฺฉูุฏ ฺฉู ฺฉุงุฑุจุฑ ุดูุง ููุด `admin` ุง `moderator` ุฏุงุฑุฏ
2. ุงฺฏุฑ moderator ูุณุชุฏุ ูุทูุฆู ุดูุฏ ฺฉู ฺฉุงุฑุจุฑ ูุฏู admin ูุณุช
3. ุจุฑุฑุณ ฺฉูุฏ ฺฉู seed ุงุฌุฑุง ุดุฏู: `npm run seed-rbac`

---

## ๐ ูุงูโูุง ูุฑุชุจุท

### Frontend

- `src/components/admin/EditUserModal.js` - ฺฉุงููพูููุช ุงุตู
- `src/components/admin/EditUserModal.module.css` - ุงุณุชุงูโูุง
- `src/app/admin/users/page.js` - ุตูุญู ูุณุช ฺฉุงุฑุจุฑุงู

### Backend

- `src/app/api/admin/users/[id]/route.js` - API endpoint
- `src/lib/models/User.model.js` - ูุฏู ฺฉุงุฑุจุฑ
- `src/lib/models/ActivityLog.model.js` - ูุงฺฏ ูุนุงูุชโูุง

### Seed

- `scripts/seed-rbac.mjs` - Seed ุงููู
- `src/app/api/admin/rbac/seed/route.js` - Seed ุงุฒ ุทุฑู API

---

**ูุณุฎู**: 1.0.0  
**ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู**: 2025-10-29  
**ููุณูุฏู**: PlusMeet Team

